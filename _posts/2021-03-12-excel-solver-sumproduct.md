---
layout: post
title: Excel规划求解凑和
---

问题：从1至20这二十个数中，找出若干个数，使得它们的和为98.

利用Excel中数据分析工具中的规划求解来求解.

步骤如下：

* 在A1:A20中输入1至20，B1:B20留空，用作可变单元格；

* 另选一个单元格如C1，在其中输入公式=SUMPRODUCT(A1:A20,B1:B20)，

该公式用于求A1\*B1+A2\*B2+...+A20\*B20. 该单元格将用于设置目标.

* 打开规划求解对话框，将进行参数设置. 

* 设置目标：C1

* 选目标值：98

* 可变单元格：B1:B20

* 约束条件中分别添加B1:B20 <= 1,B1:B20 >= 0,B1:B20 int 整数，

这样约束后，可变单元格的值只能是0或1.或B1:B20 bin 二进制.

* 点击求解

稍等后，可以求得一解：13+15+16+17+18+19.

如果无解，可求最优近似解.

修改C1中的公式=ABS(SUMPRODUCT(A1:A20,B1:B20)-98)，

将规划求解参数中目标值改选“最小”.